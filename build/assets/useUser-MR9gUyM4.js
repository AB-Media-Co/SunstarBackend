import{u as e,a,b as r}from"./query-vendor-B-W3jWpx.js";import{c as s,d as o}from"./index-Bl04lSVd.js";const n=e=>a({queryKey:["user-info",e],queryFn:async()=>{var a,r;if(!e||""===e.trim())return{id:null,isVerified:!1,email:null,phone:null,firstName:null,lastName:null,role:null,loyalAgent:null,bookingDetails:[]};try{return(await s.get(`/api/user/get-user?email=${e}`)).data}catch(n){throw o.error("Failed to fetch user info: "+((null==(r=null==(a=null==n?void 0:n.response)?void 0:a.data)?void 0:r.message)||n.message)),n}},enabled:!!e&&""!==e.trim(),staleTime:1e4,refetchOnWindowFocus:!1}),i=()=>e({mutationFn:async e=>(await s.post("/api/user/send-otp",e)).data,onSuccess:()=>{o.success("OTP sent successfully")},onError:e=>{var a,r;o.error((null==(r=null==(a=null==e?void 0:e.response)?void 0:a.data)?void 0:r.message)||e.message)}}),t=e=>a({queryKey:["check-email-verification",e],queryFn:async()=>{var a,r;if(!e||""===e.trim())return{verified:!1};try{return(await s.get(`/api/user/check-verification?email=${e}`)).data}catch(n){throw o.error("Verification check failed: "+((null==(r=null==(a=null==n?void 0:n.response)?void 0:a.data)?void 0:r.message)||n.message)),n}},enabled:!!e,staleTime:3e4,refetchOnWindowFocus:!1}),l=()=>e({mutationFn:async e=>(await s.post("/api/user/verify-otp",e)).data,onSuccess:()=>{o.success("OTP verified successfully")},onError:e=>{var a,r;o.error("Failed to verify OTP: "+(null==(r=null==(a=null==e?void 0:e.response)?void 0:a.data)?void 0:r.message)||e.message)}}),u=()=>e({mutationFn:async({hotelCode:e,apiKey:a,reservationNo:r})=>{var o,n,i,t;try{return(await s.post("/api/user/cancelBooking",{hotelCode:e,apiKey:a,reservationNo:r})).data}catch(l){if(axios.isAxiosError(l))throw new Error((null==(n=null==(o=l.response)?void 0:o.data)?void 0:n.message)||(null==(t=null==(i=l.response)?void 0:i.data)?void 0:t.error)||"Failed to cancel booking");throw l}},onSuccess:()=>{o.success("Booking cancelled successfully")},onError:e=>{const a=e instanceof Error?e.message:"Failed to cancel booking due to an unexpected error";o.error(a)},onSettled:()=>{}}),d=()=>{const a=r();return e({mutationFn:async e=>(await s.put("/api/user/update-profile",e)).data,onSuccess:(e,r)=>{o.success("Profile updated successfully"),(null==r?void 0:r.email)&&a.invalidateQueries({queryKey:["user-info",r.email]})},onError:e=>{var a,r;o.error("Failed to update profile: "+((null==(r=null==(a=null==e?void 0:e.response)?void 0:a.data)?void 0:r.message)||e.message))}})},c=()=>e({mutationFn:async e=>{const a=new FormData;if(a.append("name",e.name??""),a.append("appliedFor",e.appliedFor??""),a.append("phoneNumber",e.phoneNumber??""),a.append("emailId",e.emailId??""),a.append("gender",e.gender??""),a.append("submittedAt",e.submittedAt??(new Date).toISOString()),e.adminEmail&&a.append("adminEmail",e.adminEmail),!(e.resume instanceof File))throw new Error("Resume file is required");a.append("resume",e.resume,e.resume.name);const{data:r}=await s.post("/api/user/jobs/apply",a,{headers:{"Content-Type":"multipart/form-data"}});return r},onSuccess:()=>{o.success("Application submitted. Check your email!")},onError:e=>{var a,r;o.error((null==(r=null==(a=null==e?void 0:e.response)?void 0:a.data)?void 0:r.message)||e.message||"Failed to apply")}});export{i as a,l as b,t as c,c as d,u as e,d as f,n as u};
