import{a as e,b as a,u as t}from"./query-vendor-B-W3jWpx.js";import{d as s,c as n}from"./index-Bl04lSVd.js";const u={all:["venues"],list:e=>["venues","list",e],detail:e=>["venues","detail",e]},r=async e=>{const{data:a}=await n.post("/api/venues",e);return a},l=async({id:e,updates:a})=>{const{data:t}=await n.put(`/api/venues/${e}`,a);return t},i=async e=>{const{data:a}=await n.delete(`/api/venues/${e}`);return a},o=(a={},t={})=>e({queryKey:u.list(a),queryFn:()=>(async(e={})=>{const{data:a}=await n.get("/api/venues",{params:e});return a})(a),keepPreviousData:!0,staleTime:6e4,...t}),d=()=>{const e=a();return t({mutationFn:r,onSuccess:a=>{var t;e.invalidateQueries({queryKey:u.all}),(null==(t=null==a?void 0:a.data)?void 0:t._id)&&e.setQueryData(u.detail(a.data._id),a),s.success("Venue created successfully")},onError:e=>{var a,t;s.error((null==(t=null==(a=null==e?void 0:e.response)?void 0:a.data)?void 0:t.message)||"Failed to create venue")}})},c=()=>{const e=a();return t({mutationFn:l,onSuccess:a=>{const t=null==a?void 0:a.data;(null==t?void 0:t._id)&&e.setQueryData(u.detail(t._id),a),e.invalidateQueries({queryKey:u.all}),s.success("Venue updated successfully")},onError:e=>{var a,t;s.error((null==(t=null==(a=null==e?void 0:e.response)?void 0:a.data)?void 0:t.message)||"Failed to update venue")}})},v=()=>{const e=a();return t({mutationFn:i,onMutate:async a=>{await e.cancelQueries({queryKey:u.all});const t=e.getQueriesData({queryKey:u.all});return t.forEach((([t,s])=>{if(!(null==s?void 0:s.data))return;const n={...s,data:s.data.filter((e=>e._id!==a)),total:Math.max(0,(s.total??0)-1)};e.setQueryData(t,n)})),{prevLists:t}},onError:(a,t,n)=>{var u,r,l;null==(u=null==n?void 0:n.prevLists)||u.forEach((([a,t])=>{e.setQueryData(a,t)})),s.error((null==(l=null==(r=null==a?void 0:a.response)?void 0:r.data)?void 0:l.message)||"Failed to delete venue")},onSuccess:()=>{s.success("Venue deleted successfully")},onSettled:()=>{e.invalidateQueries({queryKey:u.all})}})};export{d as a,c as b,v as c,o as u};
