import{U as D,r as c,a4 as V,a5 as A,a6 as F,j as e,a7 as R,Z as d}from"./index-L7Rh_mQn.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U=D("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),$=({closeModal:y})=>{const[o,m]=c.useState(1),[l,v]=c.useState(""),[i,k]=c.useState({firstName:"",lastName:"",phone:""}),[u,p]=c.useState(["","","","","",""]),[x,N]=c.useState(!1),[r,n]=c.useState(!1),[g,w]=c.useState(!1),h=V(),E=A(),{data:f,refetch:C}=F(l),S=async()=>{var t;if(!l.includes("@")){d.error("Enter a valid email");return}w(!0);try{(t=(await C()).data)!=null&&t.verified?(n(!0),h.mutate({email:l},{onSuccess:()=>{n(!1),m(3)},onError:()=>{n(!1)}})):m(2)}catch{console.error("Failed to verify email. Please try again.")}finally{w(!1)}},P=()=>{const{firstName:t,lastName:s,phone:a}=i;if(!t.trim()){d.error("Please enter your first name");return}if(!s.trim()){d.error("Please enter your last name");return}if(!a.trim()){d.error("Please enter your phone number");return}if(a.length<10){d.error("Please enter a valid phone number");return}n(!0),h.mutate({email:l,...i},{onSuccess:()=>{n(!1),m(3)},onError:()=>{n(!1),console.error("Failed to send OTP. Please try again.")}})},O=async()=>{const t=u.join("");if(t.length!==6){d.error("Please enter full 6-digit OTP");return}N(!0),E.mutate({email:l,otp:t,...i},{onSuccess:()=>{localStorage.setItem("user_email",l),localStorage.setItem("user_email",l),y()},onError:()=>{N(!1),console.error("Invalid OTP. Please try again.")}})},L=(t,s)=>{if(s.length<=1){const a=[...u];if(a[t]=s,p(a),s&&t<6){const j=document.getElementById(`otp-${t+1}`);j&&j.focus()}}},I=(t,s)=>{if(s.key==="Backspace"&&!u[t]&&t>0){const a=document.getElementById(`otp-${t-1}`);a&&a.focus()}},B=()=>{n(!0),p(["","","","","",""]),h.mutate({email:l,...i},{onSuccess:()=>{n(!1)},onError:()=>{n(!1)}})},b=(t,s)=>{k(a=>({...a,[t]:s}))},T=()=>o===2?1:o===3?f!=null&&f.verified?1:2:1;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsx("div",{className:"bg-white rounded-2xl overflow-hidden shadow-2xl max-w-4xl w-full max-h-[90vh] flex",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-1/2 bg-yellow-400 text-white p-6 hidden md:block",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-white text-4xl font-bold mb-2",children:"Road Warrior"}),e.jsx("p",{className:"text-white text-lg opacity-90",children:"Get a 5% extra discount after your first stay."})]}),e.jsx("img",{src:"/images/road-warrior.svg",alt:"Car",className:""})]}),e.jsxs("div",{className:"flex-1 p-8 relative",children:[e.jsx("button",{onClick:y,className:"absolute top-6 right-6 p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(R,{className:"w-6 h-6 text-gray-500"})}),(o===2||o===3)&&e.jsxs("button",{onClick:()=>m(T()),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-6 transition-colors",children:[e.jsx(U,{className:"w-5 h-5"}),"Back"]}),o===1&&e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Login or Join"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Manage bookings, track benefits & save up to 15% extra on every stay with Bloom loyalty."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:l,onChange:t=>v(t.target.value),placeholder:"Enter Email Address",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent outline-none transition-all",disabled:g||r})]}),e.jsx("button",{onClick:S,disabled:g||r,className:"w-full bg-yellow-400 hover:bg-yellow-500 disabled:bg-yellow-300 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:g?"Checking...":r?"Sending OTP...":"Continue"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-6",children:"By continuing, you agree to the terms of use, privacy & cookie policy."})]}),o===2&&e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Complete Your Profile"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Please provide your details to continue"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:i.firstName,onChange:t=>b("firstName",t.target.value),placeholder:"Enter First Name",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent outline-none transition-all",disabled:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:i.lastName,onChange:t=>b("lastName",t.target.value),placeholder:"Enter Last Name",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent outline-none transition-all",disabled:r})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:i.phone,onChange:t=>b("phone",t.target.value),placeholder:"Enter Phone Number",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent outline-none transition-all",disabled:r})]}),e.jsx("button",{onClick:P,disabled:r,className:"w-full bg-yellow-400 hover:bg-yellow-500 disabled:bg-yellow-300 disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:r?"Sending OTP...":"Continue"})]})]}),o===3&&e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Verify Email"}),e.jsxs("p",{className:"text-gray-600 mb-8",children:["Enter the 6-digit OTP sent to ",l]}),e.jsx("div",{className:"flex gap-3 justify-center",children:u.map((t,s)=>e.jsx("input",{id:`otp-${s}`,type:"text",value:t,onChange:a=>L(s,a.target.value),onKeyDown:a=>I(s,a),className:"w-14 h-14 text-center text-black text-xl font-semibold border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-yellow-400 focus:border-transparent outline-none transition-all",maxLength:"1",disabled:x},s))}),e.jsx("button",{onClick:O,className:"w-full bg-yellow-400 hover:bg-yellow-500 disabled:bg-yellow-300 disabled:cursor-not-allowed text-white py-3 px-6 rounded-lg font-semibold transition-colors",disabled:x,children:x?"Verifying...":"Continue"}),e.jsxs("p",{className:"text-xs mt-4 text-gray-500 text-center",children:["Didn't get a code?",e.jsx("button",{className:"underline text-yellow-500 ml-1 hover:text-yellow-600 disabled:text-gray-400",onClick:B,disabled:r||x,children:r?"Sending...":"Resend OTP"})]})]})]})]})})})};export{$ as L};
