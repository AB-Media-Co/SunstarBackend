import{r as n,b as de,B as me,w as o,a7 as D,a as xe,k as A,j as e,I as Q,C as ue,a8 as fe,x as U}from"./index-r5cYIVeR.js";import{a as j,s as V,i as M,b as S,c as y,d as X,e as z}from"./isSameMonth-DnxCxkjz.js";import{a as Y,A as he}from"./ArrowRightAlt-soACTEa-.js";import{A as Z}from"./ArrowForwardIos-C0zMk0jB.js";const je=({setCheckInDate:P,setCheckOutDate:T,setOpenCalender:ee,hotelCode:F})=>{const[m,p]=n.useState(new Date),te=j(m,1),{closeHotelModal:v,setNights:ge}=de(),[s,N]=n.useState(null),[a,w]=n.useState(null),[k,L]=n.useState(!1),[W,se]=n.useState(null),[h,g]=n.useState(!1),E=n.useRef(null),l=JSON.parse(localStorage.getItem("hotelInfo")),C=s&&a&&(l==null?void 0:l.hotelCode)&&(l==null?void 0:l.authKey),{data:I,isLoading:R}=me(C?l.hotelCode:null,C?l.authKey:null,C?o(s,"yyyy-MM-dd"):null,C?o(a,"yyyy-MM-dd"):null);n.useEffect(()=>{const t=localStorage.getItem("checkInDate"),x=localStorage.getItem("checkOutDate"),i=D(new Date),b=(u,f)=>{let r=u?D(new Date(u)):null,c=f?D(new Date(f)):null;(!r||y(r,i))&&(r=i);const d=X(r,1);return(!c||y(c,i)||!M(c,r))&&(c=d),{inDate:r,outDate:c}};if(t||x){const{inDate:u,outDate:f}=b(t,x);N(u),w(f),localStorage.setItem("checkInDate",o(u,"yyyy-MM-dd")),localStorage.setItem("checkOutDate",o(f,"yyyy-MM-dd")),p(V(u))}},[]);const re=t=>{!s||s&&a?(N(t),w(null),g(!1)):y(t,s)?(N(t),g(!1)):U(t,s)>30?(w(t),g(!0)):(w(t),g(!1))},ae=t=>{s&&!a&&se(t)},B=xe(),H=n.useRef(I);n.useEffect(()=>{H.current=I},[I]);const K=n.useRef(R);n.useEffect(()=>{K.current=R},[R]);function ne({timeout:t=5e3,interval:x=100}={}){return new Promise(i=>{const b=Date.now(),u=()=>{const f=H.current,r=K.current;if(f||!r)return i(f??null);if(Date.now()-b>=t)return i(null);setTimeout(u,x)};u()})}const le=n.useCallback(async()=>{if(!k){L(!0);try{if(!s||!a||M(s,a))return;const t=o(s,"yyyy-MM-dd"),x=o(a,"yyyy-MM-dd");P(t),T(x);try{typeof window<"u"&&(localStorage.setItem("checkInDate",t),localStorage.setItem("checkOutDate",x))}catch{}const i=F??(l==null?void 0:l.hotelCode);if(!i)return;await ne({timeout:8e3,interval:120}),B(`/hotels/${i}`),v==null||v(),setOpenCalendar(!1)}catch(t){console.error("Error handling confirmation:",t)}finally{L(!1)}}},[k,s,a,P,T,F,l==null?void 0:l.hotelCode,B,v]),oe=["S","M","T","W","T","F","S"],G=(t,x,i)=>{const b=fe(V(t)),f=Array.from({length:42},(r,c)=>X(b,c));return e.jsxs("div",{className:"calendar-month w-full lg:w-[48%] flex flex-col gap-4 relative  p-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[x&&e.jsx("button",{onClick:()=>p(j(m,-1)),className:`text-2xl hidden  rounded-full md:flex items-center justify-center w-10 h-10 transition-all transform hover:scale-105
                ${S(m,new Date)?"bg-gray-100 text-gray-300 cursor-not-allowed":"text-white bg-primary-green hover:bg-primary-green/90 cursor-pointer shadow-md"}`,disabled:S(m,new Date),"aria-label":"Previous month",children:e.jsx(Y,{style:{width:"16px",height:"16px"}})}),e.jsx("h2",{className:"font-bold text-xl text-center w-full md:text-2xl text-primary-green",children:o(t,"MMMM yyyy")}),i&&e.jsx("button",{onClick:()=>p(j(m,1)),className:"text-2xl text-white bg-primary-green hover:bg-primary-green/90 rounded-full hidden md:flex items-center justify-center w-10 h-10 shadow-md cursor-pointer transition-all transform hover:scale-105","aria-label":"Next month",children:e.jsx(Z,{style:{width:"16px",height:"16px"}})})]}),e.jsxs("div",{className:"px-1 md:px-4",children:[e.jsx("div",{className:"calendar-header grid grid-cols-7 text-sm md:text-base text-center font-medium text-gray-500 pb-2 border-b border-gray-100",children:oe.map((r,c)=>e.jsx("div",{className:"py-2",children:r},c))}),e.jsx("div",{className:"calendar-days grid grid-cols-7 gap-y-2 sm:gap-y-3 pt-2",children:f.map((r,c)=>{const d=o(r,"M")===o(t,"M"),$=d&&s&&z(r,s),J=d&&a&&z(r,a),_=W&&s&&!a&&d&&M(r,s)&&y(r,W),q=d&&s&&a&&M(r,s)&&y(r,a),O=y(r,D(new Date)),ce=z(r,new Date);return e.jsx("div",{className:`day-cell flex items-center justify-center h-10 sm:h-12 relative
                    transition-all duration-200 
                    ${d?"current-month":"other-month opacity-0"} 
                    ${$?"range-start bg-primary-green rounded-l-full z-10":""} 
                    ${J?"range-end bg-primary-green rounded-r-full z-10":""} 
                    ${q||_?"in-range bg-primary-green/20":""} 
                    ${O?"text-gray-300 cursor-not-allowed":d?"hover:bg-primary-green/10 cursor-pointer":""} 
                    ${ce&&!$?"today ring-2 ring-primary-green/30 ring-inset":""}
                    `,onClick:()=>d&&!O&&re(r),onMouseEnter:()=>d&&!O&&ae(r),children:d&&e.jsx("div",{className:`
                      flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-full
                      text-sm md:text-base font-medium
                      ${$||J?"bg-primary-green text-white transform scale-110 shadow-md z-20":q||_?"text-primary-green":""}
                    `,children:o(r,"d")})},c)})})]})]})},ie=()=>{if(s&&a){const t=U(a,s);return t===1?"1 Night":`${t} Nights`}return""};return n.useEffect(()=>{h&&E.current&&A.fromTo(E.current,{opacity:0,y:-20,scale:.95},{opacity:1,y:0,scale:1,duration:.5,ease:"back.out(1.7)"})},[h]),n.useEffect(()=>{A.fromTo(".Calender",{x:300,opacity:0},{duration:.8,x:0,opacity:1,ease:"power3.out"}),A.fromTo(".footer",{y:50,opacity:0},{duration:.8,y:0,opacity:1,ease:"power3.out",delay:.3})},[]),e.jsxs("div",{className:"calendar-container flex flex-col justify-start md:justify-end relative",children:[e.jsxs("div",{className:"flex flex-col  overflow-y-auto md:rounded-t-xl md:h-auto Calender max-h-[85vh] bg-white lg:w-[95%] w-full md:p-6 lg:flex-row gap-6 shadow-lg",children:[h&&e.jsx("div",{ref:E,className:`absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 z-50 \r
              bg-white rounded-xl shadow-xl p-5 md:p-6 max-w-[90%] w-[320px] md:w-[360px]`,children:e.jsxs("div",{className:"flex flex-col items-center text-start",children:[e.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-primary-green/10 rounded-full flex items-center justify-center mb-3",children:e.jsx(Q,{name:"calendar",className:"w-6 h-6 md:w-7 md:h-7 text-primary-green"})}),e.jsx("h3",{className:"text-lg md:text-xl font-bold text-primary-dark-green mb-2",children:"Planning a long stay?"}),e.jsx("p",{className:"text-gray-600 text-sm md:text-base mb-4",children:"Currently, we don't support online bookings for more than 30 nights. However, you can tell us about your plans and we'll make it happen."}),e.jsxs("div",{className:"flex justify-between w-full items-center",children:[e.jsx("div",{className:`text-primary-yellow  w-full cursor-pointer  font-bold  \r
                  transition-all duration-300  `,onClick:()=>window.location.href="/booking-form",children:"Get in touch"}),e.jsx("div",{className:" text-gray-500 hover:text-gray-700 w-full cursor-pointer  text-sm font-medium",onClick:()=>{localStorage.removeItem("checkInDate"),localStorage.removeItem("checkOutDate"),N(null),w(null),g(!1)},children:"Continue selection"})]})]})}),h&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm z-40",onClick:()=>g(!1)}),e.jsxs("div",{className:"flex flex-col w-full gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pt-4 md:hidden",children:[e.jsx("button",{onClick:()=>p(j(m,-1)),className:`rounded-full flex items-center justify-center w-8 h-8 
                ${S(m,new Date)?"bg-gray-100 text-gray-300 cursor-not-allowed":"text-white bg-primary-green hover:bg-primary-green/90 cursor-pointer"}`,disabled:S(m,new Date),children:e.jsx(Y,{style:{width:"12px",height:"12px"}})}),e.jsx("h2",{className:"font-bold text-lg text-primary-green",children:"Select your stay dates"}),e.jsx("button",{onClick:()=>p(j(m,1)),className:"text-white bg-primary-green hover:bg-primary-green/90 rounded-full flex items-center justify-center w-8 h-8",children:e.jsx(Z,{style:{width:"12px",height:"12px"}})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row w-full gap-6",children:[G(m,!0,!1),G(te,!1,!0)]})]})]}),e.jsx("button",{onClick:()=>ee(!1),className:"absolute right-4 top-4 text-gray-500 hover:text-gray-700 transition-colors bg-white/80 hover:bg-white rounded-full p-1 shadow-md z-20","aria-label":"Close calendar",children:e.jsx(ue,{})}),e.jsxs("div",{className:`footer bg-white w-full py-4 md:py-6 shadow-lg\r
  fixed md:sticky bottom-0 left-0 z-40 \r
  px-4 md:px-8\r
  flex flex-col md:flex-row justify-between gap-4 items-center `,children:[e.jsxs("div",{className:"flex flex-row items-center justify-between w-full md:w-auto md:max-w-[60%] bg-gray-50 px-4 py-3 md:px-6 md:py-4 rounded-xl gap-3 shadow-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{name:"calendar",className:"w-5 h-5 md:w-6 md:h-6 text-primary-green mr-2"}),e.jsxs("div",{className:`flex flex-col ${k&&!s?"text-red-500":"text-gray-700"}`,children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check in"}),e.jsx("span",{className:"font-semibold text-[10px] md:text-base",children:s?o(s,"EEE, MMM d"):"Select date"})]})]}),e.jsx(he,{className:"text-primary-green mx-1 md:mx-2"}),e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:`flex flex-col ${k&&!a?"text-red-500":"text-gray-700"}`,children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check out"}),e.jsx("span",{className:"font-semibold text-[10px] md:text-base",children:a?o(a,"EEE, MMM d"):"Select date"})]})}),s&&a&&e.jsx("div",{className:"flex items-center justify-center text-xs md:text-sm font-medium text-primary-green bg-primary-green/10 rounded-full px-3 py-1 ml-2",children:ie()})]}),e.jsx("button",{onClick:le,disabled:h,className:`w-full md:w-auto font-bold text-white px-6 py-3 md:py-4 rounded-xl shadow-lg transition-all duration-300 
              ${!s||!a||h?"bg-gray-300 cursor-not-allowed":"bg-primary-dark-green hover:bg-primary-green transform hover:scale-105"}`,children:"Confirm Dates"})]})]})};export{je as C};
