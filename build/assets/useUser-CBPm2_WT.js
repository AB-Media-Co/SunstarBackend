var e=(e,r,n)=>new Promise(((a,o)=>{var l=e=>{try{s(n.next(e))}catch(r){o(r)}},i=e=>{try{s(n.throw(e))}catch(r){o(r)}},s=e=>e.done?a(e.value):Promise.resolve(e.value).then(l,i);s((n=n.apply(e,r)).next())}));import{g as r,h as n,_ as a,l as o}from"./react-vendor-tq68JOgp.js";import{c as l}from"./index-BZBH8CwT.js";const i=r=>n({queryKey:["user-info",r],queryFn:()=>e(void 0,null,(function*(){var e,n;if(!r||""===r.trim())return{id:null,isVerified:!1,email:null,phone:null,firstName:null,lastName:null,role:null,loyalAgent:null,bookingDetails:[]};try{return(yield l.get(`/api/user/get-user?email=${r}`)).data}catch(o){throw a.error("Failed to fetch user info: "+((null==(n=null==(e=null==o?void 0:o.response)?void 0:e.data)?void 0:n.message)||o.message)),o}})),enabled:!!r&&""!==r.trim(),staleTime:1e4,refetchOnWindowFocus:!1}),s=()=>r({mutationFn:r=>e(void 0,null,(function*(){return(yield l.post("/api/user/send-otp",r)).data})),onSuccess:()=>{a.success("OTP sent successfully")},onError:e=>{var r,n;a.error((null==(n=null==(r=null==e?void 0:e.response)?void 0:r.data)?void 0:n.message)||e.message)}}),t=r=>n({queryKey:["check-email-verification",r],queryFn:()=>e(void 0,null,(function*(){var e,n;if(!r||""===r.trim())return{verified:!1};try{return(yield l.get(`/api/user/check-verification?email=${r}`)).data}catch(o){throw a.error("Verification check failed: "+((null==(n=null==(e=null==o?void 0:o.response)?void 0:e.data)?void 0:n.message)||o.message)),o}})),enabled:!!r,staleTime:3e4,refetchOnWindowFocus:!1}),u=()=>r({mutationFn:r=>e(void 0,null,(function*(){return(yield l.post("/api/user/verify-otp",r)).data})),onSuccess:()=>{a.success("OTP verified successfully")},onError:e=>{var r,n;a.error("Failed to verify OTP: "+(null==(n=null==(r=null==e?void 0:e.response)?void 0:r.data)?void 0:n.message)||e.message)}}),d=()=>r({mutationFn:r=>e(void 0,[r],(function*({hotelCode:e,apiKey:r,reservationNo:n}){var a,o,i,s;try{return(yield l.post("/api/user/cancelBooking",{hotelCode:e,apiKey:r,reservationNo:n})).data}catch(t){if(axios.isAxiosError(t))throw new Error((null==(o=null==(a=t.response)?void 0:a.data)?void 0:o.message)||(null==(s=null==(i=t.response)?void 0:i.data)?void 0:s.error)||"Failed to cancel booking");throw t}})),onSuccess:()=>{a.success("Booking cancelled successfully")},onError:e=>{const r=e instanceof Error?e.message:"Failed to cancel booking due to an unexpected error";a.error(r)},onSettled:()=>{}}),c=()=>{const n=o();return r({mutationFn:r=>e(void 0,null,(function*(){return(yield l.put("/api/user/update-profile",r)).data})),onSuccess:(e,r)=>{a.success("Profile updated successfully"),(null==r?void 0:r.email)&&n.invalidateQueries({queryKey:["user-info",r.email]})},onError:e=>{var r,n;a.error("Failed to update profile: "+((null==(n=null==(r=null==e?void 0:e.response)?void 0:r.data)?void 0:n.message)||e.message))}})},p=()=>r({mutationFn:r=>e(void 0,null,(function*(){var e,n,a,o,i,s;const t=new FormData;if(t.append("name",null!=(e=r.name)?e:""),t.append("appliedFor",null!=(n=r.appliedFor)?n:""),t.append("phoneNumber",null!=(a=r.phoneNumber)?a:""),t.append("emailId",null!=(o=r.emailId)?o:""),t.append("gender",null!=(i=r.gender)?i:""),t.append("submittedAt",null!=(s=r.submittedAt)?s:(new Date).toISOString()),r.adminEmail&&t.append("adminEmail",r.adminEmail),!(r.resume instanceof File))throw new Error("Resume file is required");t.append("resume",r.resume,r.resume.name);const{data:u}=yield l.post("/api/user/jobs/apply",t,{headers:{"Content-Type":"multipart/form-data"}});return u})),onSuccess:()=>{a.success("Application submitted. Check your email!")},onError:e=>{var r,n;a.error((null==(n=null==(r=null==e?void 0:e.response)?void 0:r.data)?void 0:n.message)||e.message||"Failed to apply")}});export{s as a,u as b,t as c,p as d,d as e,c as f,i as u};
