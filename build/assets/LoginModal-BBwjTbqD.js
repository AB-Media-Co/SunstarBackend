import{j as e}from"./ui-vendor-ib5n1sau.js";import{a as t}from"./react-vendor-TJBKpoaW.js";import{d as s}from"./index-Bl04lSVd.js";import{a,b as r,c as l}from"./useUser-MR9gUyM4.js";import{X as n}from"./x-BOzcIeat.js";import{c as o}from"./createLucideIcon-qEM6W6i8.js";
/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m=o("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),i=({closeModal:o})=>{const[i,d]=t.useState(1),[c,x]=t.useState(""),[u,p]=t.useState({firstName:"",lastName:"",phone:""}),[g,b]=t.useState(["","","","","",""]),[h,y]=t.useState(!1),[f,j]=t.useState(!1),[N,v]=t.useState(!1),w=a(),k=r(),{data:C,refetch:S}=l(c),E=(e,t)=>{p((s=>({...s,[e]:t})))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl z-50 overflow-hidden shadow-2xl w-full max-w-sm sm:max-w-md md:max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col md:flex-row",children:[e.jsx("div",{className:"hidden md:block md:w-1/2",children:e.jsx("img",{src:{1:"/images/Loginorjoin.png",2:"/images/completeprofile.png",3:"/images/verifyemail.png"}[i],alt:1===i?"Login or Join":2===i?"Complete Your Profile":"Verify Email",className:"object-cover object-center w-full h-full"})}),e.jsxs("div",{className:"flex-1 p-4 sm:p-6 md:p-8 relative overflow-y-auto",children:[e.jsx("button",{onClick:o,className:"absolute top-3 right-3 sm:top-4 sm:right-4 md:top-6 md:right-6 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:e.jsx(n,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-500"})}),(2===i||3===i)&&e.jsxs("button",{onClick:()=>d(2===i?1:3===i?(null==C?void 0:C.verified)?1:2:1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4 sm:mb-6 transition-colors",children:[e.jsx(m,{className:"w-4 h-4 sm:w-5 sm:h-5"}),e.jsx("span",{className:"text-sm sm:text-base",children:"Back"})]}),e.jsxs("div",{className:"max-w-sm sm:max-w-md mx-auto pt-2  md:pt-0",children:[1===i&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Login or Join"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:"Track bookings, get rewards & enjoy up to 15% off with Sunstar."}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Email Address"}),e.jsx("input",{type:"email",value:c,onChange:e=>x(e.target.value),placeholder:"Enter Email Address",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:N||f})]}),e.jsx("button",{onClick:async()=>{var e;if(c.includes("@")){v(!0);try{(null==(e=(await S()).data)?void 0:e.verified)?(j(!0),w.mutate({email:c},{onSuccess:()=>{j(!1),d(3)},onError:()=>{j(!1)}})):d(2)}catch(t){}finally{v(!1)}}else s.error("Enter a valid email")},disabled:N||f,className:"w-full bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors text-sm sm:text-base",children:N?"Checking...":f?"Sending OTP...":"Continue"})]}),e.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-4 sm:mt-6",children:"By continuing, you agree to the terms of use, privacy & cookie policy."})]}),2===i&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Complete Your Profile"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:"Please provide your details to continue"}),e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"First Name"}),e.jsx("input",{type:"text",value:u.firstName,onChange:e=>E("firstName",e.target.value),placeholder:"Enter First Name",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Last Name"}),e.jsx("input",{type:"text",value:u.lastName,onChange:e=>E("lastName",e.target.value),placeholder:"Enter Last Name",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:f})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Phone Number"}),e.jsx("input",{type:"tel",value:u.phone,onChange:e=>E("phone",e.target.value),placeholder:"Enter Phone Number",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:f})]}),e.jsx("button",{onClick:()=>{const{firstName:e,lastName:t,phone:a}=u;e.trim()?t.trim()?a.trim()?a.length<10?s.error("Please enter a valid phone number"):(j(!0),w.mutate({email:c,...u},{onSuccess:()=>{j(!1),d(3)},onError:()=>{j(!1)}})):s.error("Please enter your phone number"):s.error("Please enter your last name"):s.error("Please enter your first name")},disabled:f,className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors text-sm sm:text-base",children:f?"Sending OTP...":"Continue"})]})]}),3===i&&e.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Verify Email"}),e.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:["Enter the 6-digit OTP sent to ",c]}),e.jsx("div",{className:"flex gap-2 sm:gap-3 justify-center",children:g.map(((t,s)=>e.jsx("input",{id:`otp-${s}`,type:"text",value:t,onChange:e=>((e,t)=>{if(t.length<=1){const s=[...g];if(s[e]=t,b(s),t&&e<6){const t=document.getElementById(`otp-${e+1}`);t&&t.focus()}}})(s,e.target.value),onKeyDown:e=>((e,t)=>{if("Backspace"===t.key&&!g[e]&&e>0){const t=document.getElementById("otp-"+(e-1));t&&t.focus()}})(s,e),className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 text-center text-black text-lg sm:text-xl font-semibold border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",maxLength:"1",disabled:h},s)))}),e.jsx("button",{onClick:async()=>{const e=g.join("");6===e.length?(y(!0),k.mutate({email:c,otp:e,...u},{onSuccess:()=>{localStorage.setItem("user_email",c),localStorage.setItem("user_email",c),o()},onError:()=>{y(!1)}})):s.error("Please enter full 6-digit OTP")},className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white py-2 sm:py-3 px-4 sm:px-6 rounded-lg font-semibold transition-colors text-sm sm:text-base",disabled:h,children:h?"Verifying...":"Continue"}),e.jsxs("p",{className:"text-xs sm:text-sm mt-4 text-gray-500 text-center",children:["Didn't get a code?",e.jsx("button",{className:"underline text-primary-green ml-1 disabled:text-gray-400",onClick:()=>{j(!0),b(["","","","","",""]),w.mutate({email:c,...u},{onSuccess:()=>{j(!1)},onError:()=>{j(!1)}})},disabled:f||h,children:f?"Sending...":"Resend OTP"})]})]})]})]})]})})};export{i as L};
