var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,l=Object.prototype.propertyIsEnumerable,n=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r,o=(e,t)=>{for(var s in t||(t={}))a.call(t,s)&&n(e,s,t[s]);if(r)for(var s of r(t))l.call(t,s)&&n(e,s,t[s]);return e},i=(e,t,s)=>new Promise(((r,a)=>{var l=e=>{try{o(s.next(e))}catch(t){a(t)}},n=e=>{try{o(s.throw(e))}catch(t){a(t)}},o=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,n);o((s=s.apply(e,t)).next())}));import{r as m,j as c,X as d,at as x,_ as u}from"./react-vendor-tq68JOgp.js";import{a as p,b,c as g}from"./useUser-CBPm2_WT.js";const h=({closeModal:e})=>{const[r,a]=m.useState(1),[l,n]=m.useState(""),[h,y]=m.useState({firstName:"",lastName:"",phone:""}),[f,j]=m.useState(["","","","","",""]),[v,N]=m.useState(!1),[w,k]=m.useState(!1),[P,S]=m.useState(!1),C=p(),E=b(),{data:O,refetch:L}=g(l),T=(e,r)=>{y((a=>{return l=o({},a),t(l,s({[e]:r}));var l}))};return c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4",children:c.jsxs("div",{className:"bg-white rounded-2xl z-50 overflow-hidden shadow-2xl w-full max-w-sm sm:max-w-md md:max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col md:flex-row",children:[c.jsx("div",{className:"hidden md:block md:w-1/2",children:c.jsx("img",{src:{1:"/images/Loginorjoin.png",2:"/images/completeprofile.png",3:"/images/verifyemail.png"}[r],alt:1===r?"Login or Join":2===r?"Complete Your Profile":"Verify Email",className:"object-cover object-center w-full h-full"})}),c.jsxs("div",{className:"flex-1 p-4 sm:p-6 md:p-8 relative overflow-y-auto",children:[c.jsx("button",{onClick:e,className:"absolute top-3 right-3 sm:top-4 sm:right-4 md:top-6 md:right-6 p-2 hover:bg-gray-100 rounded-full transition-colors z-10",children:c.jsx(d,{className:"w-5 h-5 sm:w-6 sm:h-6 text-gray-500"})}),(2===r||3===r)&&c.jsxs("button",{onClick:()=>a(2===r?1:3===r?(null==O?void 0:O.verified)?1:2:1),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-4 sm:mb-6 transition-colors",children:[c.jsx(x,{className:"w-4 h-4 sm:w-5 sm:h-5"}),c.jsx("span",{className:"text-sm sm:text-base",children:"Back"})]}),c.jsxs("div",{className:"max-w-sm sm:max-w-md mx-auto pt-2  md:pt-0",children:[1===r&&c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Login or Join"}),c.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:"Track bookings, get rewards & enjoy up to 15% off with Sunstar."}),c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Email Address"}),c.jsx("input",{type:"email",value:l,onChange:e=>n(e.target.value),placeholder:"Enter Email Address",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:P||w})]}),c.jsx("button",{onClick:()=>i(void 0,null,(function*(){var e;if(l.includes("@")){S(!0);try{(null==(e=(yield L()).data)?void 0:e.verified)?(k(!0),C.mutate({email:l},{onSuccess:()=>{k(!1),a(3)},onError:()=>{k(!1)}})):a(2)}catch(t){}finally{S(!1)}}else u.error("Enter a valid email")})),disabled:P||w,className:"w-full bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors text-sm sm:text-base",children:P?"Checking...":w?"Sending OTP...":"Continue"})]}),c.jsx("p",{className:"text-xs sm:text-sm text-gray-500 mt-4 sm:mt-6",children:"By continuing, you agree to the terms of use, privacy & cookie policy."})]}),2===r&&c.jsxs(c.Fragment,{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Complete Your Profile"}),c.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:"Please provide your details to continue"}),c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"First Name"}),c.jsx("input",{type:"text",value:h.firstName,onChange:e=>T("firstName",e.target.value),placeholder:"Enter First Name",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:w})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Last Name"}),c.jsx("input",{type:"text",value:h.lastName,onChange:e=>T("lastName",e.target.value),placeholder:"Enter Last Name",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:w})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-gray-700 font-medium mb-2 text-sm sm:text-base",children:"Phone Number"}),c.jsx("input",{type:"tel",value:h.phone,onChange:e=>T("phone",e.target.value),placeholder:"Enter Phone Number",className:"w-full px-3 sm:px-4 py-2 sm:py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all text-sm sm:text-base",disabled:w})]}),c.jsx("button",{onClick:()=>{const{firstName:e,lastName:t,phone:s}=h;e.trim()?t.trim()?s.trim()?s.length<10?u.error("Please enter a valid phone number"):(k(!0),C.mutate(o({email:l},h),{onSuccess:()=>{k(!1),a(3)},onError:()=>{k(!1)}})):u.error("Please enter your phone number"):u.error("Please enter your last name"):u.error("Please enter your first name")},disabled:w,className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-2 sm:py-3 px-4 sm:px-6 rounded-lg transition-colors text-sm sm:text-base",children:w?"Sending OTP...":"Continue"})]})]}),3===r&&c.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-gray-800 mb-2",children:"Verify Email"}),c.jsxs("p",{className:"text-sm sm:text-base text-gray-600 mb-6 sm:mb-8",children:["Enter the 6-digit OTP sent to ",l]}),c.jsx("div",{className:"flex gap-2 sm:gap-3 justify-center",children:f.map(((e,t)=>c.jsx("input",{id:`otp-${t}`,type:"text",value:e,onChange:e=>((e,t)=>{if(t.length<=1){const s=[...f];if(s[e]=t,j(s),t&&e<6){const t=document.getElementById(`otp-${e+1}`);t&&t.focus()}}})(t,e.target.value),onKeyDown:e=>((e,t)=>{if("Backspace"===t.key&&!f[e]&&e>0){const t=document.getElementById("otp-"+(e-1));t&&t.focus()}})(t,e),className:"w-10 h-10 sm:w-12 sm:h-12 md:w-14 md:h-14 text-center text-black text-lg sm:text-xl font-semibold border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",maxLength:"1",disabled:v},t)))}),c.jsx("button",{onClick:()=>i(void 0,null,(function*(){const t=f.join("");6===t.length?(N(!0),E.mutate(o({email:l,otp:t},h),{onSuccess:()=>{localStorage.setItem("user_email",l),localStorage.setItem("user_email",l),e()},onError:()=>{N(!1)}})):u.error("Please enter full 6-digit OTP")})),className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white py-2 sm:py-3 px-4 sm:px-6 rounded-lg font-semibold transition-colors text-sm sm:text-base",disabled:v,children:v?"Verifying...":"Continue"}),c.jsxs("p",{className:"text-xs sm:text-sm mt-4 text-gray-500 text-center",children:["Didn't get a code?",c.jsx("button",{className:"underline text-primary-green ml-1 disabled:text-gray-400",onClick:()=>{k(!0),j(["","","","","",""]),C.mutate(o({email:l},h),{onSuccess:()=>{k(!1)},onError:()=>{k(!1)}})},disabled:w||v,children:w?"Sending...":"Resend OTP"})]})]})]})]})]})})};export{h as L};
