import{c as D,r as c,bs as A,bt as F,bu as R,j as e,bo as U,a2 as d}from"./index-9HUsMSC5.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _=D("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),z=({closeModal:b})=>{const[a,m]=c.useState(1),[n,w]=c.useState(""),[i,k]=c.useState({firstName:"",lastName:"",phone:""}),[u,y]=c.useState(["","","","","",""]),[g,N]=c.useState(!1),[l,o]=c.useState(!1),[p,j]=c.useState(!1),x=A(),E=F(),{data:f,refetch:S}=R(n),C=async()=>{var t;if(!n.includes("@")){d.error("Enter a valid email");return}j(!0);try{(t=(await S()).data)!=null&&t.verified?(o(!0),x.mutate({email:n},{onSuccess:()=>{o(!1),m(3)},onError:()=>{o(!1)}})):m(2)}catch(r){console.error("Failed to verify email. Please try again.",r)}finally{j(!1)}},P=()=>{const{firstName:t,lastName:r,phone:s}=i;if(!t.trim()){d.error("Please enter your first name");return}if(!r.trim()){d.error("Please enter your last name");return}if(!s.trim()){d.error("Please enter your phone number");return}if(s.length<10){d.error("Please enter a valid phone number");return}o(!0),x.mutate({email:n,...i},{onSuccess:()=>{o(!1),m(3)},onError:()=>{o(!1),console.error("Failed to send OTP. Please try again.")}})},O=async()=>{const t=u.join("");if(t.length!==6){d.error("Please enter full 6-digit OTP");return}N(!0),E.mutate({email:n,otp:t,...i},{onSuccess:()=>{localStorage.setItem("user_email",n),localStorage.setItem("user_email",n),b()},onError:()=>{N(!1),console.error("Invalid OTP. Please try again.")}})},L=(t,r)=>{if(r.length<=1){const s=[...u];if(s[t]=r,y(s),r&&t<6){const v=document.getElementById(`otp-${t+1}`);v&&v.focus()}}},I=(t,r)=>{if(r.key==="Backspace"&&!u[t]&&t>0){const s=document.getElementById(`otp-${t-1}`);s&&s.focus()}},T=()=>{o(!0),y(["","","","","",""]),x.mutate({email:n,...i},{onSuccess:()=>{o(!1)},onError:()=>{o(!1)}})},h=(t,r)=>{k(s=>({...s,[t]:r}))},V=()=>a===2?1:a===3?f!=null&&f.verified?1:2:1,B={1:"/images/Loginorjoin.png",2:"/images/completeprofile.png",3:"/images/verifyemail.png"};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",children:e.jsx("div",{className:"bg-white rounded-2xl overflow-hidden shadow-2xl max-w-4xl w-full max-h-[90vh] flex",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"w-1/2 hidden md:block",children:e.jsx("img",{src:B[a],alt:a===1?"Login or Join":a===2?"Complete Your Profile":"Verify Email",className:"object-cover object-center w-full h-full"})}),e.jsxs("div",{className:"flex-1 p-8 relative",children:[e.jsx("button",{onClick:b,className:"absolute top-6 right-6 p-2 hover:bg-gray-100 rounded-full transition-colors",children:e.jsx(U,{className:"w-6 h-6 text-gray-500"})}),(a===2||a===3)&&e.jsxs("button",{onClick:()=>m(V()),className:"flex items-center gap-2 text-gray-600 hover:text-gray-800 mb-6 transition-colors",children:[e.jsx(_,{className:"w-5 h-5"}),"Back"]}),a===1&&e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Login or Join"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Track bookings, get rewards & enjoy up to 15% off with Sunstar."}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Email Address"}),e.jsx("input",{type:"email",value:n,onChange:t=>w(t.target.value),placeholder:"Enter Email Address",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",disabled:p||l})]}),e.jsx("button",{onClick:C,disabled:p||l,className:"w-full bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:p?"Checking...":l?"Sending OTP...":"Continue"})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-6",children:"By continuing, you agree to the terms of use, privacy & cookie policy."})]}),a===2&&e.jsxs("div",{className:"max-w-md mx-auto",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Complete Your Profile"}),e.jsx("p",{className:"text-gray-600 mb-8",children:"Please provide your details to continue"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"First Name"}),e.jsx("input",{type:"text",value:i.firstName,onChange:t=>h("firstName",t.target.value),placeholder:"Enter First Name",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Last Name"}),e.jsx("input",{type:"text",value:i.lastName,onChange:t=>h("lastName",t.target.value),placeholder:"Enter Last Name",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 font-medium mb-2",children:"Phone Number"}),e.jsx("input",{type:"tel",value:i.phone,onChange:t=>h("phone",t.target.value),placeholder:"Enter Phone Number",className:"w-full px-4 py-3 border text-black border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",disabled:l})]}),e.jsx("button",{onClick:P,disabled:l,className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white font-semibold py-3 px-6 rounded-lg transition-colors",children:l?"Sending OTP...":"Continue"})]})]}),a===3&&e.jsxs("div",{className:"max-w-md mx-auto space-y-6",children:[e.jsx("h2",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Verify Email"}),e.jsxs("p",{className:"text-gray-600 mb-8",children:["Enter the 6-digit OTP sent to ",n]}),e.jsx("div",{className:"flex gap-3 justify-center",children:u.map((t,r)=>e.jsx("input",{id:`otp-${r}`,type:"text",value:t,onChange:s=>L(r,s.target.value),onKeyDown:s=>I(r,s),className:"w-14 h-14 text-center text-black text-xl font-semibold border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-green focus:border-transparent outline-none transition-all",maxLength:"1",disabled:g},r))}),e.jsx("button",{onClick:O,className:"w-full bg-primary-green hover:bg-primary-green disabled:bg-primary-green disabled:cursor-not-allowed text-white py-3 px-6 rounded-lg font-semibold transition-colors",disabled:g,children:g?"Verifying...":"Continue"}),e.jsxs("p",{className:"text-xs mt-4 text-gray-500 text-center",children:["Didnt get a code?",e.jsx("button",{className:"underline text-primary-green ml-1  disabled:text-gray-400",onClick:T,disabled:l||g,children:l?"Sending...":"Resend OTP"})]})]})]})]})})})};export{z as L};
