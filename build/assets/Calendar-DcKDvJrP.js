import{c as le,j as e,R as re,r as s,a6 as ne,a7 as P,v as c,b as oe,a as ie,a8 as ce,i as W,z as de,w as U,a9 as me,I as V,C as xe}from"./index-DnhW1SVy.js";import{s as B,a as ue,i as $,b as L,c as D,d as S,e as q}from"./isSameMonth-HuVmQwU3.js";import{a as Z,A as fe}from"./ArrowRightAlt-uG_kA85w.js";const ee=le(e.jsx("path",{d:"M6.23 20.23 8 22l10-10L8 2 6.23 3.77 14.46 12z"})),X=re.memo(function({month:d,allowPrev:N,allowNext:z,onPrev:y,onNext:j,daysInWeek:T,checkIn:m,checkOut:t,hoverDate:u,onDayClick:a,onDayHover:g}){const i=s.useMemo(()=>ne(B(d)),[d]),I=42,E=s.useMemo(()=>Array.from({length:I},(r,o)=>ue(i,o)),[i]),A=s.useMemo(()=>P(new Date),[]);return e.jsxs("div",{className:"w-full lg:w-[48%] flex flex-col gap-4 relative p-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[N?e.jsx("button",{onClick:y,className:`hidden md:flex w-10 h-10 items-center justify-center rounded-full text-white shadow-md transition hover:scale-105 ${$(d,new Date)?"bg-gray-100 text-gray-300 cursor-not-allowed":"bg-primary-green"}`,disabled:$(d,new Date),"aria-label":"Previous month",children:e.jsx(Z,{style:{width:16,height:16}})}):e.jsx("span",{className:"w-10"}),e.jsx("h2",{className:"font-bold text-xl md:text-2xl text-primary-green text-center w-full",children:c(d,"MMMM yyyy")}),z?e.jsx("button",{onClick:j,className:"hidden md:flex w-10 h-10 items-center justify-center rounded-full text-white bg-primary-green shadow-md transition hover:scale-105","aria-label":"Next month",children:e.jsx(ee,{style:{width:16,height:16}})}):e.jsx("span",{className:"w-10"})]}),e.jsxs("div",{className:"px-1 md:px-4",children:[e.jsx("div",{className:"grid grid-cols-7 text-sm md:text-base text-center font-medium text-gray-500 pb-2 border-b border-gray-100",children:T.map((r,o)=>e.jsx("div",{className:"py-2",children:r},o))}),e.jsx("div",{className:"grid grid-cols-7 gap-y-2 sm:gap-y-3 pt-2",children:E.map((r,o)=>{const n=c(r,"M")===c(d,"M"),v=n&&m&&L(r,m),C=n&&t&&L(r,t),M=u&&m&&!t&&n&&D(r,m)&&S(r,u),x=n&&m&&t&&D(r,m)&&S(r,t),f=S(r,A),p=L(r,new Date);return e.jsx("div",{className:`flex items-center justify-center h-10 sm:h-12 relative transition ${n?"":"opacity-0"} ${v?"bg-primary-green rounded-l-full z-10":""} ${C?"bg-primary-green rounded-r-full z-10":""} ${x||M?"bg-primary-green/20":""} ${f?"text-gray-300 cursor-not-allowed":n?"hover:bg-primary-green/10 cursor-pointer":""} ${p&&!v?"ring-2 ring-primary-green/30 ring-inset":""}`,onClick:()=>n&&!f&&a(r),onMouseEnter:()=>n&&!f&&g(r),children:n&&e.jsx("div",{className:`flex items-center justify-center w-8 h-8 sm:w-10 sm:h-10 rounded-full text-sm md:text-base font-medium ${v||C?"bg-primary-green text-white scale-110 shadow-md z-20":x||M?"text-primary-green":""}`,children:c(r,"d")})},o)})})]})]})}),we=({setCheckInDate:R,setCheckOutDate:d,setOpenCalender:N,hotelCode:z})=>{const[y,j]=s.useState(()=>new Date),T=s.useMemo(()=>q(y,1),[y]),{closeHotelModal:m}=oe(),[t,u]=s.useState(null),[a,g]=s.useState(null),[i,I]=s.useState(!1),[E,A]=s.useState(null),[r,o]=s.useState(!1),n=s.useRef(null),v=ie(),C=ce(),M=s.useMemo(()=>["S","M","T","W","T","F","S"],[]);s.useMemo(()=>P(new Date),[]);const x=s.useMemo(()=>{try{return JSON.parse(localStorage.getItem("hotelInfo")||"null")}catch{return null}},[]);s.useEffect(()=>{const l=localStorage.getItem("checkInDate"),h=localStorage.getItem("checkOutDate"),w=_=>_?P(new Date(_)):null,b=w(l),k=w(h),O=P(new Date);if(!b||!k||S(b,O)||!D(k,b)||!D(k,O)){u(null),g(null);try{localStorage.removeItem("checkInDate"),localStorage.removeItem("checkOutDate")}catch{}j(B(O));return}u(b),g(k),j(B(b))},[]),s.useEffect(()=>{r&&n.current&&W.fromTo(n.current,{opacity:0,y:-20,scale:.95},{opacity:1,y:0,scale:1,duration:.5,ease:"back.out(1.7)"})},[r]),s.useEffect(()=>{W.fromTo(".Calender",{x:300,opacity:0},{duration:.8,x:0,opacity:1,ease:"power3.out"}),W.fromTo(".footer",{y:50,opacity:0},{duration:.8,y:0,opacity:1,ease:"power3.out",delay:.3})},[]);const f=z??(x==null?void 0:x.hotelCode)??null,p=(x==null?void 0:x.authKey)??null,K=s.useMemo(()=>t?c(t,"yyyy-MM-dd"):null,[t]),Q=s.useMemo(()=>a?c(a,"yyyy-MM-dd"):null,[a]),G=!!(f&&p&&K&&Q),te=de(f,p,K,Q,{enabled:G,staleTime:1e3*60*5,gcTime:1e3*60*30,refetchOnWindowFocus:!1,keepPreviousData:!0,retry:1}),J=s.useCallback(l=>{if(!t||t&&a)u(l),g(null),o(!1);else if(S(l,t))u(l),o(!1);else{const h=U(l,t);g(l),o(h>30)}},[t,a]),Y=s.useCallback(l=>{t&&!a&&A(l)},[t,a]),H=s.useCallback(()=>j(l=>q(l,-1)),[]),F=s.useCallback(()=>j(l=>q(l,1)),[]),se=s.useCallback(()=>{if(t&&a){const l=U(a,t);return l===1?"1 Night":`${l} Nights`}return""},[t,a]),ae=s.useCallback(async()=>{if(!i){I(!0);try{if(!t||!a||D(t,a))return;const l=c(t,"yyyy-MM-dd"),h=c(a,"yyyy-MM-dd");R(l),d(h);try{localStorage.setItem("checkInDate",l),localStorage.setItem("checkOutDate",h)}catch{}const w=f;if(!w)return;await C.ensureQueryData({queryKey:["rooms",w,p,l,h],queryFn:async({signal:b})=>(await me.get("/api/ezee/syncedRooms",{params:{hotelCode:w,authCode:p,fromDate:l,toDate:h},signal:b})).data,staleTime:1e3*60*5,gcTime:1e3*60*30}),v(`/hotels/${w}`),m(),N(!1)}catch(l){console.error("Confirm error:",l)}finally{I(!1)}}},[m,i,t,a,R,d,f,p,C,v,N]);return e.jsxs("div",{className:"calendar-container flex flex-col justify-start md:justify-end relative",children:[e.jsxs("div",{className:"Calender flex flex-col bg-white lg:w-[95%] w-full md:p-6 lg:flex-row gap-6 shadow-lg md:rounded-t-xl overflow-y-auto max-h-[85vh]",children:[r&&e.jsx("div",{ref:n,className:"absolute z-50 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 bg-white rounded-xl shadow-xl p-5 md:p-6 w-[320px] md:w-[360px] max-w-[90%]",children:e.jsxs("div",{className:"flex flex-col items-center text-start",children:[e.jsx("div",{className:"w-12 h-12 md:w-14 md:h-14 bg-primary-green/10 rounded-full flex items-center justify-center mb-3",children:e.jsx(V,{name:"calendar",className:"w-6 h-6 md:w-7 md:h-7 text-primary-green"})}),e.jsx("h3",{className:"text-lg md:text-xl font-bold text-primary-dark-green mb-2",children:"Planning a long stay?"}),e.jsx("p",{className:"text-gray-600 text-sm md:text-base mb-4",children:"Currently, we don't support online bookings for more than 30 nights. However, you can tell us about your plans and we'll make it happen."}),e.jsxs("div",{className:"flex justify-between w-full items-center",children:[e.jsx("button",{type:"button",className:"text-primary-yellow w-full font-bold text-left",onClick:()=>window.location.href="/booking-form",children:"Get in touch"}),e.jsx("button",{type:"button",className:"text-gray-500 hover:text-gray-700 w-full text-right text-sm font-medium",onClick:()=>{localStorage.removeItem("checkInDate"),localStorage.removeItem("checkOutDate"),u(null),g(null),o(!1)},children:"Continue selection"})]})]})}),r&&e.jsx("div",{className:"absolute inset-0 bg-black/40 backdrop-blur-sm z-40",onClick:()=>o(!1)}),e.jsxs("div",{className:"flex flex-col w-full gap-4",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 pt-4 md:hidden",children:[e.jsx("button",{onClick:H,className:`flex w-8 h-8 items-center justify-center rounded-full ${$(y,new Date)?"bg-gray-100 text-gray-300 cursor-not-allowed":"text-white bg-primary-green"}`,disabled:$(y,new Date),"aria-label":"Previous month",children:e.jsx(Z,{style:{width:12,height:12}})}),e.jsx("h2",{className:"font-bold text-lg text-primary-green",children:"Select your stay dates"}),e.jsx("button",{onClick:F,className:"flex w-8 h-8 items-center justify-center rounded-full text-white bg-primary-green","aria-label":"Next month",children:e.jsx(ee,{style:{width:12,height:12}})})]}),e.jsxs("div",{className:"flex flex-col md:flex-row w-full gap-6",children:[e.jsx(X,{month:y,allowPrev:!0,allowNext:!1,onPrev:H,onNext:F,daysInWeek:M,checkIn:t,checkOut:a,hoverDate:E,onDayClick:J,onDayHover:Y}),e.jsx(X,{month:T,allowPrev:!1,allowNext:!0,onPrev:H,onNext:F,daysInWeek:M,checkIn:t,checkOut:a,hoverDate:E,onDayClick:J,onDayHover:Y})]})]})]}),e.jsx("button",{onClick:()=>N(!1),className:"absolute right-4 top-4 text-gray-500 hover:text-gray-700 transition-colors bg-white/80 hover:bg-white rounded-full p-1 shadow-md z-20","aria-label":"Close calendar",children:e.jsx(xe,{})}),e.jsxs("div",{className:"footer fixed md:sticky bottom-0 left-0 z-40 bg-white w-full px-4 md:px-8 py-4 md:py-6 shadow-lg",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between gap-4 items-center",children:[e.jsxs("div",{className:"flex items-center w-full md:w-auto md:max-w-[60%] bg-gray-50 px-4 py-3 md:px-6 md:py-4 rounded-xl gap-3 shadow-md",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(V,{name:"calendar",className:"w-5 h-5 md:w-6 md:h-6 text-primary-green mr-2"}),e.jsxs("div",{className:`flex flex-col ${i&&!t?"text-red-500":"text-gray-700"}`,children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check in"}),e.jsx("span",{className:"font-semibold text-[10px] md:text-base",children:t?c(t,"EEE, MMM d"):"Select date"})]})]}),e.jsx(fe,{className:"text-primary-green mx-1 md:mx-2"}),e.jsx("div",{className:"flex items-center",children:e.jsxs("div",{className:`flex flex-col ${i&&!a?"text-red-500":"text-gray-700"}`,children:[e.jsx("span",{className:"text-xs text-gray-500 font-medium",children:"Check out"}),e.jsx("span",{className:"font-semibold text-[10px] md:text-base",children:a?c(a,"EEE, MMM d"):"Select date"})]})}),t&&a&&e.jsx("div",{className:"ml-2 flex items-center justify-center text-xs md:text-sm font-medium text-primary-green bg-primary-green/10 rounded-full px-3 py-1",children:se()})]}),e.jsx("button",{onClick:ae,disabled:!t||!a||r||i,className:`w-full md:w-auto font-bold text-white px-6 py-3 md:py-4 rounded-xl shadow-lg transition ${!t||!a||r||i?"bg-gray-300 cursor-not-allowed":"bg-primary-dark-green hover:bg-primary-green"}`,children:i?"Loadingâ€¦":"Confirm Dates"})]}),te.isError&&G&&e.jsx("p",{className:"text-red-600 text-xs mt-2",children:"Could not load availability. Please try again."})]})]})};export{ee as A,we as C};
