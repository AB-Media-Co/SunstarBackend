var u=(e,s,n)=>new Promise((t,i)=>{var d=a=>{try{r(n.next(a))}catch(m){i(m)}},p=a=>{try{r(n.throw(a))}catch(m){i(m)}},r=a=>a.done?t(a.value):Promise.resolve(a.value).then(d,p);r((n=n.apply(e,s)).next())});import{y as l,g as f,f as c,h as o,x as g}from"./index-Do7zHJPr.js";const h=e=>f({queryKey:["user-info",e],queryFn:()=>u(void 0,null,function*(){var s,n;if(!e||e.trim()==="")return{id:null,isVerified:!1,email:null,phone:null,firstName:null,lastName:null,role:null,loyalAgent:null,bookingDetails:[]};try{return(yield c.get(`/api/user/get-user?email=${e}`)).data}catch(t){throw o.error("Failed to fetch user info: "+(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||t.message)),t}}),enabled:!!e&&e.trim()!=="",staleTime:1e4,refetchOnWindowFocus:!1}),w=()=>l({mutationFn:e=>u(void 0,null,function*(){return(yield c.post("/api/user/send-otp",e)).data}),onSuccess:()=>{o.success("OTP sent successfully")},onError:e=>{var s,n;o.error(((n=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:n.message)||e.message)}}),E=e=>f({queryKey:["check-email-verification",e],queryFn:()=>u(void 0,null,function*(){var s,n;if(!e||e.trim()==="")return{verified:!1};try{return(yield c.get(`/api/user/check-verification?email=${e}`)).data}catch(t){throw o.error("Verification check failed: "+(((n=(s=t==null?void 0:t.response)==null?void 0:s.data)==null?void 0:n.message)||t.message)),t}}),enabled:!!e,staleTime:3e4,refetchOnWindowFocus:!1}),k=()=>l({mutationFn:e=>u(void 0,null,function*(){return(yield c.post("/api/user/verify-otp",e)).data}),onSuccess:()=>{o.success("OTP verified successfully")},onError:e=>{var s,n;o.error("Failed to verify OTP: "+((n=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:n.message)||e.message)}}),S=()=>l({mutationFn:t=>u(void 0,[t],function*({hotelCode:e,apiKey:s,reservationNo:n}){var i,d,p,r;try{return(yield c.post("/api/user/cancelBooking",{hotelCode:e,apiKey:s,reservationNo:n})).data}catch(a){throw axios.isAxiosError(a)?new Error(((d=(i=a.response)==null?void 0:i.data)==null?void 0:d.message)||((r=(p=a.response)==null?void 0:p.data)==null?void 0:r.error)||"Failed to cancel booking"):a}}),onSuccess:()=>{o.success("Booking cancelled successfully")},onError:e=>{const s=e instanceof Error?e.message:"Failed to cancel booking due to an unexpected error";o.error(s)},onSettled:()=>{}}),q=()=>{const e=g();return l({mutationFn:s=>u(void 0,null,function*(){return(yield c.put("/api/user/update-profile",s)).data}),onSuccess:(s,n)=>{o.success("Profile updated successfully"),n!=null&&n.email&&e.invalidateQueries({queryKey:["user-info",n.email]})},onError:s=>{var n,t;o.error("Failed to update profile: "+(((t=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:t.message)||s.message))}})},O=()=>{const e=g();return l({mutationFn:t=>u(void 0,[t],function*({email:s,amountUsed:n}){return(yield c.post("/api/user/deduct-earnings",{email:s,amountUsed:n})).data}),onSuccess:(s,n)=>{console.log("âœ… Earnings deducted:",s),n!=null&&n.email&&e.invalidateQueries({queryKey:["user-info",n.email]})},onError:s=>{var n,t;console.error("Failed to deduct earnings:",s),o.error("Failed to deduct earnings: "+(((t=(n=s==null?void 0:s.response)==null?void 0:n.data)==null?void 0:t.message)||s.message))}})},C=()=>l({mutationFn:e=>u(void 0,null,function*(){var t,i,d,p,r,a;const s=new FormData;if(s.append("name",(t=e.name)!=null?t:""),s.append("appliedFor",(i=e.appliedFor)!=null?i:""),s.append("phoneNumber",(d=e.phoneNumber)!=null?d:""),s.append("emailId",(p=e.emailId)!=null?p:""),s.append("gender",(r=e.gender)!=null?r:""),s.append("submittedAt",(a=e.submittedAt)!=null?a:new Date().toISOString()),e.adminEmail&&s.append("adminEmail",e.adminEmail),e.resume instanceof File)s.append("resume",e.resume,e.resume.name);else throw new Error("Resume file is required");const{data:n}=yield c.post("/api/user/jobs/apply",s,{headers:{"Content-Type":"multipart/form-data"}});return n}),onSuccess:()=>{o.success("Application submitted. Check your email!")},onError:e=>{var s,n;o.error(((n=(s=e==null?void 0:e.response)==null?void 0:s.data)==null?void 0:n.message)||e.message||"Failed to apply")}});export{O as a,w as b,k as c,E as d,C as e,S as f,q as g,h as u};
