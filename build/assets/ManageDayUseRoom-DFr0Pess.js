var e=(e,s,l)=>new Promise(((a,r)=>{var t=e=>{try{o(l.next(e))}catch(s){r(s)}},d=e=>{try{o(l.throw(e))}catch(s){r(s)}},o=e=>e.done?a(e.value):Promise.resolve(e.value).then(t,d);o((l=l.apply(e,s)).next())}));import{r as s,j as l,ae as a}from"./react-vendor-tq68JOgp.js";import{useGetHotels as r}from"./useHotelHook2-lvucTAR8.js";import{h as t,i as d,j as o}from"./useDayUseRoomHook-KRcOgMMR.js";import{l as i}from"./date-vendor-9E3U4XI3.js";import"./animation-vendor-DJegggv9.js";import"./vendor-DwD9zxym.js";import"./query-vendor-iDpT9gG9.js";import"./ui-vendor-DiJ4VKpG.js";import"./swiper-vendor-DEzR9mKq.js";import"./index-BZBH8CwT.js";const n=()=>{var n,c,m,x;const[u,h]=s.useState(""),[g,b]=s.useState(""),[v,p]=s.useState(null),[j,y]=s.useState(null),[f,N]=s.useState(""),[w,C]=s.useState(!1),[k,S]=s.useState(""),[M,L]=s.useState(""),[R,D]=s.useState(""),[P,A]=s.useState(!1),[U,F]=s.useState([]),[z,H]=s.useState(""),[E,T]=s.useState(""),[$,B]=s.useState(""),{data:O,isLoading:q,error:W}=r(),{data:Y,isLoading:G,error:I}=t(g,u),J=d(),K=o();s.useEffect((()=>{if(R){const e=setTimeout((()=>D("")),5e3);return()=>clearTimeout(e)}}),[R]),s.useEffect((()=>{if(M){const e=setTimeout((()=>L("")),5e3);return()=>clearTimeout(e)}}),[M]),s.useEffect((()=>{const e=i(new Date,"yyyy-MM");g||b(e)}),[O,u,g]);const Q=(()=>{const e=new Date,s=[];for(let l=0;l<12;l++){const a=new Date(e.getFullYear(),e.getMonth()+l,1),r=i(a,"yyyy-MM"),t=i(a,"MMMM yyyy");s.push({value:r,label:t})}return s})(),V=(()=>{const e=new Date,s=[];for(let l=0;l<30;l++){const a=new Date(e.getTime()+24*l*60*60*1e3),r=i(a,"yyyy-MM-dd"),t=i(a,"dd MMM yyyy");s.push({value:r,label:t})}return s})(),X=({size:e="md",text:s="Loading..."})=>l.jsxs("div",{className:"flex items-center justify-center p-8",children:[l.jsx("div",{className:`animate-spin rounded-full ${{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[e]} border-b-2 border-blue-600`}),l.jsx("span",{className:"ml-2 text-gray-600",children:s})]}),Z=()=>l.jsx("div",{className:"fixed inset-0 bg-white bg-opacity-75 backdrop-blur-sm flex items-center justify-center z-50",children:l.jsx("div",{className:"bg-white rounded-xl shadow-2xl p-8 max-w-sm w-full mx-4",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-blue-600 border-t-transparent mx-auto mb-4"}),l.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Processing Request"}),l.jsx("p",{className:"text-gray-600 text-sm",children:"Please wait while we update your data..."})]})})}),_=()=>l.jsxs("div",{className:"bg-white shadow-sm rounded-xl mb-6 border border-gray-100 overflow-hidden animate-pulse",children:[l.jsx("div",{className:"bg-gray-200 px-6 py-4",children:l.jsx("div",{className:"flex items-center justify-between",children:l.jsxs("div",{children:[l.jsx("div",{className:"h-6 bg-gray-300 rounded w-48 mb-2"}),l.jsx("div",{className:"h-4 bg-gray-300 rounded w-32"})]})})}),l.jsx("div",{className:"p-6",children:l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 gap-3",children:[...Array(14)].map(((e,s)=>l.jsx("div",{className:"p-4 rounded-lg border bg-gray-100",children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"h-4 bg-gray-300 rounded w-12 mx-auto mb-2"}),l.jsx("div",{className:"h-3 bg-gray-300 rounded w-8 mx-auto mb-1"}),l.jsx("div",{className:"h-3 bg-gray-300 rounded w-10 mx-auto"})]})},s)))})})]}),ee=({message:e,onClose:s})=>l.jsxs("div",{className:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("p",{className:"text-sm font-medium text-red-800",children:e})})]}),l.jsx("button",{onClick:s,className:"ml-4 text-red-400 hover:text-red-600",children:l.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),se=({message:e,onClose:s})=>l.jsxs("div",{className:"mb-4 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center justify-between",children:[l.jsxs("div",{className:"flex items-center",children:[l.jsx("div",{className:"flex-shrink-0",children:l.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:l.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),l.jsx("div",{className:"ml-3",children:l.jsx("p",{className:"text-sm font-medium text-green-800",children:e})})]}),l.jsx("button",{onClick:s,className:"ml-4 text-green-400 hover:text-green-600",children:l.jsx("svg",{className:"h-4 w-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:l.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]});return q?l.jsx("div",{className:"p-6 mt-20 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"animate-pulse",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("div",{className:"h-8 bg-gray-300 rounded w-80 mb-2"}),l.jsx("div",{className:"h-4 bg-gray-300 rounded w-64"})]}),l.jsx("div",{className:"h-10 bg-gray-300 rounded w-32 mt-4 sm:mt-0"})]}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("div",{className:"h-4 bg-gray-300 rounded w-24 mb-2"}),l.jsx("div",{className:"h-12 bg-gray-300 rounded w-full"})]}),l.jsxs("div",{children:[l.jsx("div",{className:"h-4 bg-gray-300 rounded w-24 mb-2"}),l.jsx("div",{className:"h-12 bg-gray-300 rounded w-full"})]})]})})]}),l.jsx(X,{size:"lg",text:"Loading hotels and room data..."})]})}):W?l.jsx("div",{className:"p-6 mt-20 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-6",children:"Day Use Room Management"}),l.jsx(ee,{message:"Failed to load hotels. Please refresh the page.",onClose:()=>{}})]})}):l.jsx("div",{className:"p-6 mt-20 bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen",children:l.jsxs("div",{className:"max-w-7xl mx-auto",children:[l.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6",children:[l.jsxs("div",{children:[l.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Day Use Room Management"}),l.jsx("p",{className:"text-gray-600 mt-1",children:"Manage room availability across your properties"})]}),l.jsx("button",{onClick:()=>{A(!0),F([]),H(""),T(""),B("")},disabled:G||q,className:"mt-4 sm:mt-0 px-6 py-2 bg-gradient-to-r from-purple-600 to-purple-700 text-white rounded-lg hover:from-purple-700 hover:to-purple-800 transition-all duration-200 font-medium shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none",children:G||q?l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Loading..."]}):"Bulk Update"})]}),M&&l.jsx(ee,{message:M,onClose:()=>L("")}),R&&l.jsx(se,{message:R,onClose:()=>D("")}),l.jsx("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-6 mb-6",children:l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hotel Selection"}),l.jsxs("select",{value:u,onChange:e=>h(e.target.value),disabled:q,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:[l.jsx("option",{value:"",children:q?"Loading hotels...":"All Hotels"}),null==(n=null==O?void 0:O.hotels)?void 0:n.map((e=>l.jsx("option",{value:e.hotelCode.toString(),children:e.name},e.hotelCode)))]})]}),l.jsxs("div",{children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Month Selection"}),l.jsxs("select",{value:g,onChange:e=>b(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",children:[l.jsx("option",{value:"",children:"Select Month"}),Q.map((e=>l.jsx("option",{value:e.value,children:e.label},e.value)))]})]})]})}),G&&l.jsxs("div",{className:"space-y-6",children:[l.jsx(_,{}),l.jsx(_,{}),l.jsx(_,{})]}),(J.isLoading||K.isLoading)&&l.jsx(Z,{}),I&&l.jsx(ee,{message:"Failed to load room data. Please try again.",onClose:()=>{}}),!G&&0===(null==(c=null==Y?void 0:Y.data)?void 0:c.length)&&l.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-100 p-8 text-center",children:[l.jsx("div",{className:"text-gray-400 text-6xl mb-4",children:"ðŸ¨"}),l.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No Room Data Found"}),l.jsx("p",{className:"text-gray-600",children:"Select a hotel and month to view room availability"})]}),!G&&(null==(m=null==Y?void 0:Y.data)?void 0:m.map(((e,s)=>{var a,r;return l.jsxs("div",{className:"bg-white shadow-sm rounded-xl mb-6 border border-gray-100 overflow-hidden",children:[l.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4",children:l.jsxs("div",{className:"flex items-center justify-between",children:[l.jsxs("div",{children:[l.jsx("h2",{className:"text-xl font-semibold text-white",children:(null==(a=e.hotel)?void 0:a.name)||"Unknown Hotel"}),l.jsx("p",{className:"text-blue-100 text-sm",children:(null==(r=e.room)?void 0:r.RoomName)||"Unknown Room"})]}),e.error&&l.jsx("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Error"})]})}),l.jsx("div",{className:"p-6",children:e.error?l.jsx("div",{className:"text-red-600 bg-red-50 border border-red-200 rounded-lg p-4 text-center",children:l.jsx("p",{className:"font-medium",children:e.error})}):e.monthData?l.jsxs(l.Fragment,{children:[l.jsxs("div",{className:"flex items-center gap-6 mb-4 text-sm",children:[l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-green-500"}),l.jsx("span",{className:"text-gray-700",children:"Available"})]}),l.jsxs("div",{className:"flex items-center gap-2",children:[l.jsx("div",{className:"w-4 h-4 rounded-full bg-red-500"}),l.jsx("span",{className:"text-gray-700",children:"Sold Out"})]})]}),l.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-7 gap-3",children:Object.entries(e.monthData).map((([s,a])=>l.jsx("div",{className:`p-4 rounded-lg border cursor-pointer transition-all duration-200 hover:shadow-md transform hover:-translate-y-1 ${a.soldOut?"bg-red-50 border-red-200 hover:bg-red-100":"bg-green-50 border-green-200 hover:bg-green-100"} ${J.isLoading?"pointer-events-none opacity-50":""}`,onClick:()=>{var l;return((e,s,l,a)=>{y(e),p(s),N(l),S(a),C(!0),L("")})(e.room,s,a.availability,null==(l=null==e?void 0:e.hotel)?void 0:l.hotelCode)},children:l.jsxs("div",{className:"text-center",children:[l.jsx("div",{className:"text-sm font-semibold text-gray-800 mb-1",children:i(new Date(s),"dd MMM")}),l.jsxs("div",{className:"text-xs text-gray-600 mb-1",children:["â‚¹",a.rate]}),l.jsxs("div",{className:"text-xs font-medium text-gray-700",children:[a.availability," rooms"]})]})},s)))})]}):l.jsx("div",{className:"text-gray-500 text-center py-8",children:"No data available for this period"})})]},s)}))),l.jsxs(a,{open:w,onClose:()=>C(!1),className:"relative z-50",children:[l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm","aria-hidden":"true"}),l.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:l.jsxs(a.Panel,{className:"w-full max-w-md rounded-xl bg-white p-6 shadow-2xl",children:[l.jsx(a.Title,{className:"text-xl font-semibold text-gray-900 mb-4",children:"Update Room Availability"}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-4",children:[l.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Room:"}),l.jsx("p",{className:"font-medium text-gray-900",children:null==j?void 0:j.RoomName}),l.jsx("p",{className:"text-sm text-gray-600 mt-2 mb-1",children:"Date:"}),l.jsx("p",{className:"font-medium text-gray-900",children:v})]}),l.jsxs("div",{className:"mb-4",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Availability"}),l.jsx("input",{type:"number",min:"0",value:f,onChange:e=>N(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Enter new availability"})]}),M&&l.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-sm text-red-800",children:M})}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:()=>C(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),l.jsxs("button",{onClick:()=>e(void 0,null,(function*(){if(L(""),!f||Number(f)<0)L("Please enter a valid availability number");else try{yield J.mutateAsync({hotelCode:k,roomName:null==j?void 0:j.RoomName,date:v,timeSlot:"Full Day",availability:Number(f)}),D("Room availability updated successfully"),C(!1)}catch(e){L("Failed to update availability. Please try again.")}})),disabled:J.isLoading,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[J.isLoading&&l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),J.isLoading?"Saving...":"Save Changes"]})]})]})})]}),l.jsxs(a,{open:P,onClose:()=>A(!1),className:"relative z-50",children:[l.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm","aria-hidden":"true"}),l.jsx("div",{className:"fixed inset-0 flex items-center justify-center p-4",children:l.jsxs(a.Panel,{className:"w-full max-w-2xl rounded-xl bg-white p-6 shadow-2xl max-h-[90vh] overflow-y-auto",children:[l.jsx(a.Title,{className:"text-xl font-semibold text-gray-900 mb-6",children:"Bulk Update Room Availability"}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date"}),l.jsxs("select",{value:z,onChange:e=>H(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",children:[l.jsx("option",{value:"",children:"Choose a date"}),V.map((e=>l.jsx("option",{value:e.value,children:e.label},e.value)))]})]}),l.jsxs("div",{className:"mb-6",children:[l.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Hotels",l.jsxs("span",{className:"ml-2 px-2 py-1 bg-purple-100 text-purple-800 rounded-full text-xs",children:[U.length," selected"]})]}),l.jsx("div",{className:"max-h-48 overflow-y-auto border border-gray-300 rounded-lg p-3 bg-gray-50",children:null==(x=null==O?void 0:O.hotels)?void 0:x.filter((e=>null==e?void 0:e.isDayUseRoom)).map((e=>l.jsxs("div",{className:"flex items-center p-2 hover:bg-white rounded-lg transition-colors duration-200",children:[l.jsx("input",{type:"checkbox",id:`hotel-${e.hotelCode}`,checked:U.includes(e.hotelCode.toString()),onChange:()=>{return s=e.hotelCode.toString(),F((e=>e.includes(s)?e.filter((e=>e!==s)):[...e,s])),void B("");var s},className:"h-4 w-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),l.jsx("label",{htmlFor:`hotel-${e.hotelCode}`,className:"ml-3 text-sm text-gray-700 cursor-pointer flex-1",children:e.name})]},e.hotelCode)))})]}),l.jsxs("div",{className:"mb-6",children:[l.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New Availability"}),l.jsx("input",{type:"number",min:"0",value:E,onChange:e=>T(e.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition-all duration-200",placeholder:"Enter availability for all selected hotels"})]}),$&&l.jsx("div",{className:"mb-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:l.jsx("p",{className:"text-sm text-red-800",children:$})}),l.jsxs("div",{className:"flex justify-end gap-3",children:[l.jsx("button",{onClick:()=>A(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors duration-200",children:"Cancel"}),l.jsxs("button",{onClick:()=>e(void 0,null,(function*(){var e;if(B(""),z&&0!==U.length&&""!==E)if(Number(E)<0)B("Availability cannot be negative");else try{const s=[];if(null==(e=null==Y?void 0:Y.data)||e.forEach((e=>{var l,a,r;U.includes(null==(a=null==(l=e.hotel)?void 0:l.hotelCode)?void 0:a.toString())&&s.push({hotelCode:e.hotel.hotelCode.toString(),roomName:null==(r=e.room)?void 0:r.RoomName,timeSlot:"Full Day",availability:Number(E)})})),0===s.length)return void B("No rooms found for selected hotels");const l={date:z,updates:s};yield K.mutateAsync(l),D(`Successfully updated ${s.length} room(s) for ${U.length} hotel(s)`),A(!1)}catch(s){B("Failed to update rooms. Please try again.")}else B("Please select date, hotels, and availability")})),disabled:K.isLoading,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[K.isLoading&&l.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),K.isLoading?"Updating...":"Update All Hotels"]})]})]})})]})]})})};export{n as default};
